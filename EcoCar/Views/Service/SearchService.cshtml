@using static EcoCar.Models.ServiceManagement.Service

@model EcoCar.ViewModels.ServiceViewModel
@{
    Layout = "~/Views/Shared/MainLayout.cshtml";
    ViewBag.Title = "Rechercher une prestation";
}
<!--Service List without requestedservices-->



<div class="container-fluid bg-grey">
    @*Service List Display*@
    <div class="table-responsive">
        <center><input style="width:50%" type="text" id="searchInput" onkeyup="myFunction()" placeholder="Rechercher une proposition de prestation..."></center><br />
        <table class="table" id="userTable">
            <thead>
                <tr class="header">
                    <th>Date de début</th>
                    <th>Horaire de début</th>
                    <th>Type de service</th>
                    <th>Numéro de réference</th>
                    <th>EcoMembre prestataire</th>
                    <th>Disponibilité</th>
                    <th>Reserver</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var carPoolingService in Model.CarPoolingServices)
                {
                    <tr>
                        <td>@carPoolingService.Service.Start.ToShortDateString()</td>
                        <td>@carPoolingService.Service.Start.TimeOfDay</td>
                        <td>@carPoolingService.Service.SelectServiceType</td>
                        <td>@carPoolingService.Service.ReferenceNumber</td>
                        @foreach (var user in Model.Users.Where(u=>u.Id == @carPoolingService.Service.UserProviderId))
                        {
                             <td>@user.Account.Username</td>
                        }
                        <td>@carPoolingService.Service.IsAvailable</td>
                        <td> <a href="/Service/ReserveCarPoolingService/@carPoolingService.Id"><span class="glyphicon glyphicon-paperclip  text-success"></span></a></td>
                    </tr>
                }
                @foreach (var carRentalService in Model.CarRentalServices)
                {
                    <tr>
                        <td>@carRentalService.Service.Start.ToShortDateString()</td>
                        <td>@carRentalService.Service.Start.TimeOfDay</td>
                        <td>@carRentalService.Service.SelectServiceType</td>
                        <td>@carRentalService.Service.ReferenceNumber</td>
                        @foreach (var user in Model.Users.Where(u=>u.Id == @carRentalService.Service.UserProviderId))
                        {
                             <td>@user.Account.Username</td>
                        }
                        <td>@carRentalService.Service.IsAvailable</td>
                        <td>@carRentalService.Service.IsAvailable</td>
                        <td> <a href="/Service/ReserveCarRentalService/@carRentalService.Id"><span class="glyphicon glyphicon-paperclip  text-success"></span></a></td>
                    </tr>

                   
                }

                @foreach (var parcelService in Model.ParcelServices)
                {
                    <tr>
                        <td>@parcelService.Service.Start.ToShortDateString()</td>
                        <td>@parcelService.Service.Start.TimeOfDay</td>
                        <td>@parcelService.Service.SelectServiceType</td>
                        <td>@parcelService.Service.ReferenceNumber</td>
                        @foreach (var user in Model.Users.Where(u=>u.Id == @parcelService.Service.UserProviderId))
                        {
                             <td>@user.Account.Username</td>
                        }
                        <td>@parcelService.Service.IsAvailable</td>
                        <td>@parcelService.Service.IsAvailable</td>
                    <td> <a href="/Service/ReserveParcelService/@parcelService.Id"><span class="glyphicon glyphicon-paperclip  text-success"></span></a></td>
                    </tr>
                }

                @Html.Hidden("serviceId",@ViewBag.serviceId,null)
                

            </tbody>
        </table>
    </div>
</div>

<!-- Requested services list-->
<div class="container-fluid">
    @*Service List Display*@
    <div class="table-responsive">
        <center><input style="width:50%" type="text" id="searchInput" onkeyup="myFunction()" placeholder="Rechercher une demande de prestation..."></center><br />
        <table class="table" id="userTable">
            <thead>
                <tr class="header">
                    <th>Date de début</th>
                    <th>Horaire de début</th>
                    <th>Type de service</th>
                    <th>Numéro de réference</th>
                    <th>EcoMembre demandeur</th>
                    <th>Disponibilité</th>
                    <th>Reserver</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var carPoolingServiceRequest in Model.CarPoolingServices.Where(s => s.Service.IsRequest == true))
                {
                    <tr>
                        <td>@carPoolingServiceRequest.Service.Start.ToShortDateString()</td>
                        <td>@carPoolingServiceRequest.Service.Start.TimeOfDay</td>
                        <td>@carPoolingServiceRequest.Service.SelectServiceType</td>
                        <td>@carPoolingServiceRequest.Service.ReferenceNumber</td>
                        @foreach (var user in Model.Users.Where(u=>u.Id == @carPoolingServiceRequest.Service.UserProviderId))
                        {
                             <td>@user.Account.Username</td>
                        }
                        <td>@carPoolingServiceRequest.Service.IsAvailable</td>
                        <td>@carPoolingServiceRequest.Service.IsAvailable</td>
                        <td> <a href="/Service/ReserveCarPoolingService/@carPoolingServiceRequest.Id"><span class="glyphicon glyphicon-paperclip  text-success"></span></a></td>
                    </tr>
                }
                @foreach (var carRentalServiceRequest in Model.CarRentalServices.Where(s => s.Service.IsRequest == true))
                {
                    <tr>
                        <td>@carRentalServiceRequest.Service.Start.ToShortDateString()</td>
                        <td>@carRentalServiceRequest.Service.Start.TimeOfDay</td>
                        <td>@carRentalServiceRequest.Service.SelectServiceType</td>
                        <td>@carRentalServiceRequest.Service.ReferenceNumber</td>
                        @foreach (var user in Model.Users.Where(u=>u.Id == @carRentalServiceRequest.Service.UserProviderId))
                        {
                             <td>@user.Account.Username</td>
                        }
                        <td>@carRentalServiceRequest.Service.IsAvailable</td>
                        <td> <a href="/Service/ReserveCarRentalService/@carRentalServiceRequest.Id"><span class="glyphicon glyphicon-paperclip  text-success"></span></a></td>
                    </tr>

                   
                }

                @foreach (var parcelServiceRequest in Model.ParcelServices.Where(s => s.Service.IsRequest == true))
                {
                    <tr>
                        <td>@parcelServiceRequest.Service.Start.ToShortDateString()</td>
                        <td>@parcelServiceRequest.Service.Start.TimeOfDay</td>
                        <td>@parcelServiceRequest.Service.SelectServiceType</td>
                        <td>@parcelServiceRequest.Service.ReferenceNumber</td>
                        @foreach (var user in Model.Users.Where(u=>u.Id == @parcelServiceRequest.Service.UserProviderId))
                        {
                             <td>@user.Account.Username</td>
                        }
                        <td>@parcelServiceRequest.Service.IsAvailable</td>
                    <td> <a href="/Service/ReserveParcelService/@parcelServiceRequest.Id"><span class="glyphicon glyphicon-paperclip  text-success"></span></a></td>
                    </tr>
                }

                @Html.Hidden("serviceId",@ViewBag.serviceId,null)
                

            </tbody>
        </table>
    </div>
</div>
<script>
    function myFunction() {
        var input, filter, table, tr, td, cell, i, j;
        filter = document.getElementById("searchInput").value.toLowerCase();
        table = document.getElementById("userTable");
        tr = table.getElementsByTagName("tr");
        for (i = 1; i < tr.length; i++) {
            tr[i].style.display = "none";
            const tdArray = tr[i].getElementsByTagName("td");
            for (var j = 0; j < tdArray.length; j++) {
                const cellValue = tdArray[j];
                if (cellValue && cellValue.innerHTML.toLowerCase().indexOf(filter) > -1) {
                    tr[i].style.display = "";
                    break;
                }
            }
        }
    }

</script>
